PROMPT 22: COMMAND CENTER (The React Dashboard)
Role: Senior Frontend Engineer & Data Visualization Expert Target Path: /home/ransomeye/rebuild/web/dashboard/

Goal: Build the ransomeye-dashboard (React + TypeScript). Context: This is the "Single Pane of Glass" for the platform. The backend is high-performance Rust, so the frontend must match that speed. It uses Vite for zero-latency builds and Cytoscape (or React Force Graph) to render the complex attack vectors discovered by Phase 3. It communicates via WebSockets for real-time alerts.

1. ğŸ›‘ HARD CONSTRAINTS (MUST OBEY)
Directory Standards:

Root: /home/ransomeye/rebuild/web/dashboard/

Tech Stack: React (v18+), TypeScript, Vite, TailwindCSS.

Visual Requirements:

Dark Mode Only: (Cybersecurity standard).

Graph Visualization: Must use cytoscape.js or react-force-graph to render the core/intel data (Attacker -> Host -> File).

Live Feed: Must implement a WebSocket client (ws://) to receive real-time alerts from core/bus.

Security:

No Analytics: Do NOT include Google Analytics, Mixpanel, or any external trackers. This is an air-gapped product.

Content Security Policy (CSP): The build must generate a strict CSP meta tag that denies external scripts (default-src 'self').

Integration Points:

Narrative View: A dedicated component to render the Markdown stories from Phase 16.

Sentinel Grid: A view to see the status (Online/Tampered) of every agent from Phase 21.

2. ğŸ“‚ DIRECTORY STRUCTURE & FILES
Create exactly this structure under /home/ransomeye/rebuild/web/dashboard/:

Plaintext

web/dashboard/
â”œâ”€â”€ package.json                # React/Vite dependencies
â”œâ”€â”€ vite.config.ts              # Build config (Proxy to Rust backend)
â”œâ”€â”€ index.html                  # Entry point (CSP Headers included)
â”œâ”€â”€ tailwind.config.js
â””â”€â”€ src/
    â”œâ”€â”€ main.tsx                # React Root
    â”œâ”€â”€ App.tsx                 # Layout (Sidebar + Router)
    â”œâ”€â”€ api/
    â”‚   â”œâ”€â”€ socket.ts           # WebSocket Client (Real-time Alerts)
    â”‚   â””â”€â”€ client.ts           # Fetch Wrapper (Auth Headers)
    â”œâ”€â”€ components/
    â”‚   â”œâ”€â”€ graph/
    â”‚   â”‚   â””â”€â”€ AttackMap.tsx   # Visualizes the Knowledge Graph
    â”‚   â”œâ”€â”€ narrative/
    â”‚   â”‚   â””â”€â”€ ReportCard.tsx  # Renders Phase 16 Markdown Reports
    â”‚   â””â”€â”€ sentinel/
    â”‚       â””â”€â”€ HealthGrid.tsx  # Shows Agent Status (Online/Tampered)
    â””â”€â”€ pages/
        â”œâ”€â”€ LiveOps.tsx         # Real-time Event Stream
        â””â”€â”€ Forensics.tsx       # DNA & Diffing Tools
3. âš™ï¸ IMPLEMENTATION DETAILS
A. The Attack Map (src/components/graph/AttackMap.tsx)
Library: cytoscape (or react-force-graph-2d). Data Source: Fetches JSON from GET /api/v1/intel/graph. Visuals:

Red Nodes: Attackers (IPs or external domains).

Blue Nodes: Hosts (Agents).

Edges: Connections (Protocol/Port). Interaction: Clicking a node opens an "Entity Detail" side panel showing metadata.

B. The Narrative Reader (src/components/narrative/ReportCard.tsx)
Library: react-markdown. Input: Receives the raw Markdown string generated by Phase 16 (core/narrative). Styling:

Render blockquotes as "Alert Boxes" (Border-left: Red).

Render code blocks as "Terminal Windows" (Black background, monospaced font).

C. Real-Time Socket (src/api/socket.ts)
Logic:

Open connection to ws://localhost:8080/ws.

On Message:

If type === 'ALERT', push to the global useAlertStore (Zustand/Redux).

If type === 'SENTINEL_TAMPER', trigger a full-screen "BREACH DETECTED" overlay immediately.

Reconnection: Auto-retry every 5 seconds if disconnected.

D. Sentinel Health Grid (src/components/sentinel/HealthGrid.tsx)
Display: A grid of cards representing agents. Status Logic:

ğŸŸ¢ Green: Online & Integrity Verified.

ğŸŸ¡ Yellow: Offline / Missed Heartbeat.

ğŸ”´ Red: Tamper Detected (Phase 21 triggered).

4. âœ… ACCEPTANCE CRITERIA
Build: npm run build produces a static dist/ folder containing optimized JS/CSS.

Graph Render: The Attack Map renders dummy nodes without crashing the browser.

Real-Time: Simulating a WebSocket event updates the "Live Ops" counter immediately without page refresh.

Security: The index.html contains <meta http-equiv="Content-Security-Policy" content="default-src 'self'; ...">.


Narrative: The Markdown renderer correctly formats the "Incident Story" tables and headers.